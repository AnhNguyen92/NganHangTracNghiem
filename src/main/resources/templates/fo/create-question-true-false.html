<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org">

<head>

<title>Tạo câu hỏi đúng sai</title>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="shortcut icon" href="#">
<link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap-4.4.1/css/bootstrap.min.css}" />
<link rel="stylesheet" type="text/css" th:href="@{/css/style.css}" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script type="text/javascript" th:src="@{/css/bootstrap-4.4.1/js/bootstrap.min.js}"></script>

</head>

<body>
    <!-- header -->
    <header th:replace="fragments/fo/header.html :: header "> </header>
    <!-- end header -->

    <!-- content -->
    <div class="container mt-3">
        <div class="page-title">TẠO MỚI CÂU HỎI ĐÚNG SAI</div>
        <form action="#" id="f-true-false-question" th:action="@{/fo/questions/true-false}" method="post" th:object="${mcqDto}">
            <div class="mcq">
                <div class="extention d-flex flex-row mt-3">
                    <div>Nội dung câu hỏi</div>
                    <div>
                        <input type="button" id="btn-add-note" onchange="addQuestionNote(event)">
                        <label class="cursor--lbl">
                            <i class="fa fa-sticky-note px-2" aria-hidden="true"></i>
                        </label>
                        <input type="file" accept="image/*" name="image" id="file" onchange="loadFile(event)" style="display: none;">
                        <label class="cursor--lbl" for="file">
                            <i class="fa fa-paperclip" aria-hidden="true"></i>
                        </label>
                    </div>
                    <div class="ml-auto p-2">
                        <i class="fa fa-align-right" aria-hidden="true"></i>
                        <i class="fa fa-align-center" aria-hidden="true"></i>
                        <i class="fa fa-align-left" aria-hidden="true"></i>
                        <i class="fa fa-align-justify" aria-hidden="true"></i>
                        <i class="fa fa-bold" aria-hidden="true"></i>
                        <i class="fa fa-italic" aria-hidden="true"></i>
                        <i class="fa fa-underline" aria-hidden="true"></i>
                    </div>
                </div>
                <div class="mcp-content">
                    <textarea class="question-content" th:field="*{content}"></textarea>
                </div>
                <div class="answer">
                    <div class="total-answer d-flex">
                        <div class="text-danger p-1">Số đáp án</div>
                        <div class="text-center p-1">
                            <label class="total-answer__value" th:text="${#lists.size(mcqDto.questionAnswerDtos)}">4</label>
                        </div>
                        <div class="ml-auto py-2">
                            <button class="btn-add-answer" id="btn-add-answer" type="submit" name="add-answer" onclick="return addMoreAnswer()">
                                <i class="fa fa-plus" aria-hidden="true" title="Thêm đáp án"></i>
                            </button>
                        </div>
                    </div>
                    <div class="answer-content" th:each="questionAnswerDto, questionAnswerDtoStat : *{questionAnswerDtos}">
                        <div class="answer-content__item d-flex flex-row mb-2">
                            <div>
                                <label class="answer__label" th:text="*{questionAnswerDtos[__${questionAnswerDtoStat.index}__].answerLabel}">Đáp án</label>
                            </div>
                            <div class="ml-4 w-100">
                                <input type="text" class="answer__value" title="Nội dung câu trả lời"
                                    th:field="*{questionAnswerDtos[__${questionAnswerDtoStat.index}__].answerContent}">
                            </div>
                            <div class="ml-2">
                                <input class="answer__score" title="Điểm số cho đáp án" type="number"
                                    th:field="*{questionAnswerDtos[__${questionAnswerDtoStat.index}__].score}" />
                            </div>
                            <div class="ml-2">
                                <div class="answer__true-answer">
                                    <input type="checkbox" th:id="'true-ans-' + ${questionAnswerDtoStat.index}"
                                        th:checked="*{questionAnswerDtos[__${questionAnswerDtoStat.index}__].trueAnswer}">
                                    <label title="Chọn đáp án đúng" th:for="'true-ans-' + ${questionAnswerDtoStat.index}">
                                        <span></span>
                                    </label>
                                </div>
                            </div>
                            <div class="ml-2">
                                <button class="btn-swap-answer" th:id=" 'btn-swap-pos-' + ${questionAnswerDtoStat.index} " type="button"
                                    title="Bỏ hoán vị vị trí" th:onclick="|return changePermutation(${questionAnswerDtoStat.index})|">
                                    <i class="fa fa-exchange" aria-hidden="true"></i>
                                </button>
                                <input type="checkbox" hidden="true" th:id=" 'swap-pos-' + ${questionAnswerDtoStat.index}" name="active"
                                    th:field="*{questionAnswerDtos[__${questionAnswerDtoStat.index}__].randomPosition}" />
                            </div>
                            <div class="ml-2">
                                <button class="btn-delete-answer" type="submit" name="remove-answer" th:value="${questionAnswerDtoStat.index}"
                                    onclick="return removeAnswer()">
                                    <i class="fa fa-window-close" aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="mt-3 d-flex justify-content-center pb-3">
                    <div class="mx-2">
                        <input type="submit" class="btn btn-success" value="Hoàn thành">
                    </div>
                    <div class="mx-2">
                        <input type="reset" class="btn btn-primary" value="Làm lại">
                    </div>
                    <div class="mx-2">
                        <a type="button" class="btn btn-danger" th:href="@{'/fo/index'}">Huỷ bỏ</a>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <!-- end content -->

    <!-- footer -->
    <footer th:replace="fragments/fo/footer.html :: footer">
        <p>2021 mqconline.com</p>
    </footer>
    <!-- end footer -->

    <script type="text/javascript">

    	let alphabetArr = [ 'A', 'B', 'C', 'D',
    						'E', 'F', 'G', 'H' ];	
    	
    	function onlyOneAnswer(checkbox) {
            let checkboxes = document.getElementsByClassName('checkbox-answer');
            for (item of checkboxes) {
                if (item !== checkbox) item.checked = false        	
            }
        }

        function addMoreAnswer() {
        	let totalAnswer = $(".answer__value").length;
        	if (totalAnswer == 8) {
        		alert("Số câu trả lời tối đa là 8");
        		return false;
        	} else {
        		$("#f-true-false-question").submit();
        	}
        }

        function removeAnswer() {
        	let totalAnswer = $(".answer__value").length;
        	if (totalAnswer == 4) {
        		alert("Số câu trả lời tối thiểu là 4");
        		return false;
        	} else {
        		$("#f-true-false-question").submit();
        	}
        }
        
        function getLastLabel() {
        	let answerLbls = document.getElementsByClassName('answer__label');
        	return answerLbls[answerLbls.length - 1];
        }

        function lastItem(array) {
            return array[array.length - 1];
        }

        function getCharacterByIndex(index) {
            return alphabetArr[index];
        }
        
        function indexOf(chracter) {
        	return alphabetArr.indexOf(chracter);
        }
        
        function changePermutation(inputId) {
        	let inputElm = $("#swap-pos-" + inputId);
        	if(inputElm.is(':checked')) {
        	    $(inputElm).prop('checked',false);
        	} else {
        	    $(inputElm).prop('checked',true);
        	}
        	
        	let btnSwapTitle = $("#btn-swap-pos-" + inputId).attr("title");
        	if(btnSwapTitle == "Bỏ hoán vị vị trí") {
        	    $("#btn-swap-pos-" + inputId).prop('title', 'Cho phép hoán vị vị trí');
        	} else {
        	    $("#btn-swap-pos-" + inputId).prop('title', 'Bỏ hoán vị vị trí');
        	}
        }
        
	</script>

</body>

</html>